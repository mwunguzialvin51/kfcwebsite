$(function(){$.notify=function(e){if(e.message){var t=$.extend({id:$.generateHash(8),delay:4e3,type:"information",autohide:!0,position:"top center"},e);"title"in e&&e.title||(t.title=t.type);var o=templates.render("partials/_notify.html",t);$("#notify").length||$("<div/>",{id:"notify",class:t.position}).appendTo("body"),$(o).appendTo("#notify"),$("#toast-"+t.id).toast("show")}}}),$(function(){$.generateHash=function(e){var t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";e=e||8;for(var n=0;n<e;n++)t+=o.charAt(Math.floor(Math.random()*o.length));return t}}),window.filters={dateformat:function(e,t){return dayjs(e).format(t.format||"MMM Do, YYYY")},priceformat:function(e,t){return t=t||"USD",currency_symbols={USD:"$",EUR:"&euro;"},symbol=currency_symbols[t]||t,symbol+e.toFixed(2)},filesizeformat:function(e,t){var a=t?1024:1e3,i=parseFloat(e);return 1===i?"1 Byte":i<a?i+" Bytes":["Bytes",t?"KiB":"kB",t?"MiB":"MB",t?"GiB":"GB",t?"TiB":"TB",t?"PiB":"PB",t?"EiB":"EB",t?"ZiB":"ZB",t?"YiB":"YB"].reduce(function(e,t,o){var n=Math.pow(a,o);return n<=i?(i/n).toFixed(1)+" "+t:e})},intcomma:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},sum:function(e,t){var o=0;return e.forEach(function(e){o+=e[t.attribute]}),o},title:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},pluralize:function(e){return 1!=e?"s":""}},$(function(){window.templates=new nunjucks.Environment,$.each(window.filters,function(e,t){templates.addFilter(e,t,!0)})}),$(function(){$.ajaxSetup({beforeSend:function(e,t){var o,n,a,i;i=t.type,/^(GET|HEAD|OPTIONS|TRACE)$/i.test(i)||(o=t.url,n="//"+document.location.host,a=document.location.protocol+n,o!=a&&o.slice(0,a.length+1)!=a+"/"&&o!=n&&o.slice(0,n.length+1)!=n+"/"&&/^(\/\/|http:|https:).*/.test(o))||e.setRequestHeader("X-CSRFToken",Cookies.get("csrftoken"))}}),$(document).ajaxError(function(e,t,o,n){"abort"!==n&&Sentry.captureMessage(n||t.statusText,{extra:{type:o.type,url:o.url,data:o.data,status:t.status,error:n||t.statusText,response:t.responseText}})})}),$(function(){$(".autocomplete").each(function(){var i=$(this),r=i.parents("form"),o=i.outerHeight(),a={settings:{expires:7,key:i.data("history")},get:function(t){var e=[];if(this.settings.key){var o=localStorage.getItem(this.settings.key);o&&(e=JSON.parse(o))}return t&&0<t.length&&(e=_.filter(e,function(e){return 0===e.value.lastIndexOf(t.toLowerCase(),0)})),e},set:function(e){this.settings.key&&localStorage.setItem(this.settings.key,JSON.stringify(e))}},n={url:i.data("url"),render:function(e){if(this.remove(),0<e.length){var t=templates.render("search/_suggestions.html",{input:$.trim(i.val()).toLowerCase(),suggestions:e.slice(0,6)});r.addClass("has-dropdown").append(t),r.find(".suggestions").css("top",o)}},remove:function(){r.removeClass("has-dropdown").find(".suggestions").remove()}};i.on("focus blur",function(e){var t="focus"==e.type||"click"==e.type;if($(e.relatedTarget).parents("form").is(r))return!1;r.toggleClass("focus",t),t||n.remove()}),i.on("click",function(){var e=$.trim(i.val()),t=a.get(e);n.render(t)}),r.on("mouseenter",".suggestions-list .list-group-item-action",function(e){$(".suggestions-list .list-group-item-action").removeClass("selected")}),i.on("keydown",function(e){if(13==e.which){var t=r.find(".suggestions-list .selected");0<t.length&&(t.trigger("click"),e.preventDefault(),e.stopImmediatePropagation())}}),i.on("keydown",function(e){8==e.which&&($.trim(i.val()).length||r.find(".input-group-prepend.filter-list [data-filter]:last").trigger("click"))}),i.on("keyup",function(e){if(38==e.which||40==e.which){var t=r.find(".suggestions");if(0<t.length){var o,n=t.find("[data-value]"),a=n.filter(".selected");38==e.which&&(o=0<a.length&&0<a.prev().length?a.prev():n.last()),40==e.which&&(o=0<a.length&&0<a.next().length?a.next():n.first()),o.addClass("selected"),a.removeClass("selected")}else i.trigger("click");e.stopImmediatePropagation()}}),i.on("keydown keyup",function(e){38!=e.which&&40!=e.which||e.preventDefault()}),i.on("keyup",_.throttle(function(e){var t=$.trim(i.val()).toLowerCase(),o=a.get(t);if(!(0<=$.inArray(e.key,["Shift","Alt","Control","Meta"]))){if(n.url&&t.length){if(t==i.data("value"))return;$.getJSON(n.url,{q:t},function(e){var t=$.map(e,function(e){return"string"==typeof e&&(e={q:e,value:e}),e});t=_.union(o,t),t=_.uniq(t,function(e){return e.value}),n.render(t.slice(0,8))})}else n.render(o);i.data("value",t)}},200)),r.on("submit",function(){r.addClass("submitted"),n.remove()}),r.on("submit",function(e){var t=$.trim(i.val()),o=a.get();t.length<2||(o.unshift({type:"history",value:t}),o=o.slice(0,12),o=_.uniq(o,function(e){return e.value}),a.set(o))}),r.on("click","[data-remove-history]",function(e){var t=$(this),o=t.data("remove-history"),n=a.get();return n&&(n=_.filter(n,function(e){return e.value!=o}),t.parents(".list-group-item").remove(),a.set(n),i.trigger("focus").trigger("click")),!1}),r.on("click","[data-value]",function(e){e.preventDefault();var t=$(this).data("value");r.find('input[name="q"]').val(t),r.submit()})}),Cookies.remove("search_history")}),$(function(){if($.extend(FormSerializer.patterns,{validate:/^[a-z][a-z0-9_-]*(?:\[(?:\d*|[a-z0-9_-]+)\])*$/i,key:/[a-z0-9_-]+|(?=\[\])/gi,named:/^[a-z0-9_-]+$/i}),$(document).on("click",'[data-toggle="toggle"]',function(e){e.preventDefault();var t=$(this),o=t.data("target")||t.attr("href");$(o).toggleClass("d-none")}),$('[data-toggle="tooltip"]').tooltip(),$('[data-toggle="popover"]').popover(),$(document).on("click",'.popover [data-dismiss="popover"]',function(){$(this).parents(".popover").popover("hide")}),$(document).on("mouseenter","[data-license]",function(){var t=$(this);if(!($(window).width()<600)){var e=setTimeout(function(){var e=templates.render("licenses/_summary.html",{name:t.data("license")});0<e.length?t.popover({content:e,html:!0,sanitize:!1,delay:{show:1e3},trigger:"hover",placement:"bottom"}).popover("show"):t.tooltip({title:"Licensed under "+t.data("license"),placement:"bottom"}).tooltip("show")},500);t.on("mouseleave",function(){clearTimeout(e)})}}),$(document).on("click","[data-confirm]",function(e){var t=confirm($(this).data("confirm"));return t||e.stopImmediatePropagation(),t}),$(document).on("click",'[data-toggle="tooltip"]',function(){$(this).tooltip("hide")}),$(document).on("shown.bs.collapse",".collapse",function(){$(this).find("[autofocus]").trigger("focus")}),$(".background-picker").on("click","a",function(e){e.preventDefault();var t=$(this),o=t.parents(".background-picker"),n=t.data("value");o.find(".active").removeClass("active"),t.addClass("active"),$("body").removeClass("preview-white preview-black preview-gray preview-transparent").addClass("preview-"+n),Cookies.set("icon-preview-color",n)}),$(document).on("click",'[href="/user/logout"]',function(){Intercom("shutdown")}),window.nf_messages?$.each(window.nf_messages,function(e,t){$.notify(t)}):Cookies.getJSON("flash-message")&&($.notify(Cookies.getJSON("flash-message")),Cookies.remove("flash-message")),$(document).on("click","[data-tracking]",function(){var e=$(this).data("tracking").split("|");e.length<2||ga("send",{hitType:"event",eventCategory:e[0],eventAction:e[1],eventLabel:e[2]||null,eventValue:e[3]||null})}),"true"==$.url().param("trackevent")){var e=$.url().param();ga("send",{hitType:"event",eventCategory:e.event_category,eventAction:e.event_action,eventLabel:e.event_label,eventValue:e.event_value})}$.fn.hotkey=function(){return this.each(function(){var e=$(this),t=e.data("hotkey");$(document).on("keyup",null,String(t),function(){e.trigger("focus").trigger("click"),"a"===e.prop("tagName").toLowerCase()&&(window.location=e.attr("href"))})})},$("[data-hotkey]").hotkey(),$(document).on("change","input[data-group]",function(){var e=$(this),t=e.data("group"),o=$('input[data-group="'+t+'"]');"checkall"==e.data("toggle")&&o.prop("checked",e.is(":checked"));var n=0===o.filter(":checked").length;$('button[data-group="'+t+'"]').attr("disabled",n)}),$(document).on("change",".select-navigation",function(){var e=$(this).val();window.location.replace(e)}),$(".search-form").on("submit",function(){var e=$(this),t=e.find("[data-search_url]");if(0<t.length){var o=t.data("search_url");e.attr("action",o)}}),$(".search-form .index-selector").on("shown.bs.dropdown hidden.bs.dropdown",function(){$(".search-form").removeClass("has-dropdown").find(".suggestions").remove()}),$(".search-form .index-selector a").on("click",function(e){e.preventDefault();var t=$(this),o=t.attr("href"),n=t.text(),a=$(".search-form"),i=a.find(".index-selector");i.find(".dropdown-item.active").removeClass("active"),i.find('.dropdown-item[data-action="'+o+'"]').addClass("active"),i.find("button span").text(n),a.attr("action",o)}),$(".filter-list").on("click","[data-filter]",function(e){e.preventDefault();var t=$(this),o=t.data("filter"),n=$(".search-form");n.find('[name="'+o+'"]').remove(),t.tooltip("dispose").remove(),Cookies.remove(o),n.find(".filter-list [data-filter]").length||(n.find(".index-selector").removeClass("d-none"),n.find('input[name="q"]').each(function(){var e=$(this),t=e.data("placeholder");e.attr("placeholder",t)}))}),$("#billing-interval input").on("change",function(){$("[data-interval]").toggleClass("d-none")}),$.confirmPayment=function(e,t){t=t||$.noop(),$("body").loading(!0,{title:"Authenticating",description:"Please wait..."}),ga("send","event","Commerce","Payment confirmation (3D secure)","Requested"),stripe.handleCardPayment(e).then(function(e){$("body").loading(!1),e.error?($.notify({type:"danger",message:e.error.message,autohide:!1}),ga("send","event","Commerce","Payment confirmation (3D secure)","Error: "+e.error.message)):(t(e),ga("send","event","Commerce","Payment confirmation (3D secure)","Confirmed"))})},$(document).on("click","[data-link]",function(e){var t=$(e.target);if(!t.is("a")&&!t.is("button")&&!getSelection().toString()){var o=$(this).data("link");e.ctrlKey||e.metaKey?window.open(o,"_blank"):location.href=o}}),$.fn.formatJSON=function(){return this.each(function(e,t){var o=$(t),n=$.trim(o.val());n&&o.val(JSON.stringify(JSON.parse(n),void 0,4))})},$(".pretty-json").formatJSON(),$(document).on("change","[data-setting]",function(){var e=$(this),t=e.data("setting");e.is(":checked")?Cookies.set(t,"true"):Cookies.remove(t)}),$(document).find("[data-load]").each(function(){var t=$(this),o=t.data("load"),e=t.data("trigger"),n=t.data("method"),a=function(){$.get(o,function(e){"replace"==n?t.replaceWith(e):t.html(e),$(document).trigger("load-success",{element:t,url:o}),$('[data-toggle="tooltip"]').tooltip()})};switch(e){case"click":t.on("click",a);break;case"scroll":break;default:a()}}),$(window).on("load",function(){setTimeout(function(){"undefined"!=typeof _carbonads&&0!==$("#banner_ad .carbon-wrap").length||($("#banner_ad").remove(),$("#banner_fallback").removeClass("d-none"))},1e3)}),$(document).on("mouseenter",".screened-popover",function(){var e=$(this);e.popover({html:!0,sanitize:!1,trigger:"manual",placement:"bottom",content:function(){return e.siblings("template").html()}}).popover("show"),$(document).one("click",function(){e.popover("hide")})})}),$(function(){$.fn.loading=function(e,t){if($(".loading-overlay").remove(),e){var o=$.extend({animation:!0,title:"Loading, please wait..."},t),n=templates.render("partials/_loading.html",o);this.append(n),$(".tooltip").tooltip("hide")}}}),$(function(){$(document).on("click",'[data-requires="user"]',function(e){var t=$(this);if("undefined"==typeof USER){e.preventDefault(),e.stopImmediatePropagation();var o={},n=t.attr("href");n&&"#"!==n&&(o.redirect=n),renderModal("signup/_modal",o)}}),$(document).on("keydown","#login-modal #login-form",function(e){13==e.keyCode&&$(this).submit()}),$(document).on("form.submit.success","#login-form",function(e){ga("send","event","User","Log in","Logged in successfully"),ga("send","pageview","/user/login/success")}),$(document).on("form.submit.error","#login-form",function(e,t){var o=$(this);ga("send","event","User","Log in","Error"),o.parents(".modal-content").loading(!1),t&&t.errors&&"g-recaptcha-response"in t.errors&&(o.recaptcha(t),e.stopImmediatePropagation())}),$(document).on("form.submit.success","#signup-form",function(e){ga("send","event","User","Sign up","Signed up successfully"),ga("send","pageview","/user/signup/success")}),$(document).on("form.submit.error","#signup-form",function(e,t){var o=$(this);o.parents(".modal-content").loading(!1),ga("send","event","User","Sign up","Error"),t&&t.errors&&"g-recaptcha-response"in t.errors&&(o.recaptcha(t),e.stopImmediatePropagation())}),$.loadFacebookSDK=function(e){e=e||$.noop(),$.getScript("https://connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:window.SOCIAL_AUTH_FACEBOOK_KEY,xfbml:!0,version:"v2.8"}),e()})},$(document).on("click",'[data-toggle="facebook"]',function(){var t=$(this).parents("form");t.attr("action",window.SOCIAL_AUTH_FACEBOOK_URL),$.loadFacebookSDK(function(){FB.login(function(e){e.authResponse&&"accessToken"in e.authResponse?($("<input />",{name:"access_token",value:e.authResponse.accessToken}).appendTo(t),$("<input />",{name:"csrfmiddlewaretoken",value:Cookies.get("csrftoken")}).appendTo(t),t.submit()):ga("send","event","User","Connect with Facebook","Cancelled")},{scope:"public_profile,email"})})})}),$(function(){$(document).on("blur",".email-validation input",function(e){var o=$(this),t=$.trim(o.val()),n=o.parents(".custom-validation"),a=window.DEBOUNCE_PUBLIC_KEY;0<t.length&&a&&(n.addClass("loading").removeClass("success warning"),$("#email-did-you-mean").addClass("d-none"),$.ajax({url:"https://api.debounce.io/v1/",data:{api:a,email:t,gsuite:!0},success:function(e){if(e&&"debounce"in e&&"code"in e.debounce)if(5==e.debounce.code)n.addClass("success");else if("did_you_mean"in e.debounce&&0<e.debounce.did_you_mean.length){var t=e.debounce.did_you_mean;$("#email-did-you-mean").removeClass("d-none").find("span").text(t),$("#email-did-you-mean a").on("click",function(e){e.preventDefault(),o.val(t),$("#email-did-you-mean").addClass("d-none")})}else e.debounce.code in[1,6]&&n.addClass("warning")},complete:function(){n.removeClass("loading")}}))})}),$(function(){$.fn.recaptcha=function(){var e=this.find("#recaptcha-holder"),t=templates.render("partials/_recaptcha.html",{recaptcha_public_key:window.RECAPTCHA_PUBLIC_KEY});e.html(t),this.trigger("recaptcha-attached")},$(document).on("submit","form.needs-validation",function(e){var t=e.currentTarget,o=t.checkValidity();$(t).addClass("was-validated"),$(t).removeClass("server-validated"),$(t).find(".invalid-feedback.added").remove(),o||(e.preventDefault(),e.stopImmediatePropagation())}),$(document).on("click",'[data-toggle="submit"]',function(){var e=$(this);$(e.data("target")).submit()}),$(document).on("submit",'form[data-submit="ajax"]',function(e){e.preventDefault();var t=$(this);$.ajax({url:t.attr("action"),method:t.attr("method"),data:t.serializeObject(),success:function(e){t.trigger("form.submit.success",e)},error:function(e){t.trigger("form.submit.error",e.responseJSON)},complete:function(e){t.trigger("form.submit.complete",e.responseJSON)}})}),$(document).on("form.submit.success",'form[data-submit="ajax"]',function(e){var t=$(this),o={type:"success",title:t.data("success-title"),message:t.data("success-message")};switch(t.data("success")){case"reload":Cookies.set("flash-message",o),location.reload();break;case"redirect":Cookies.set("flash-message",o),location.replace(t.data("success-url"));break;default:$.notify(o)}}),$(document).on("form.submit.error",'form[data-submit="ajax"]',function(e,t){var n=$(this),o={type:"danger",title:n.data("error-title"),message:n.data("error-message")||"Something went wrong"};t&&("message"in t&&(o.message=t.message),"errors"in t&&(n.removeClass("was-validated").addClass("server-validated"),$.each(t.errors,function(e,t){var o=n.find("[name="+e+"]");o.parent().find(".invalid-feedback.added").remove(),o.addClass("is-invalid").after('<div class="invalid-feedback added">'+t+"</div>")}))),$.notify(o)}),$(document).on("change",'[data-autosubmit="true"]',function(){$(this).parents("form").submit()})}),$(function(){$(document).on("click","[data-remote]",function(e){e.preventDefault();var t=$(this),o=t.data(),n=$("body");t.parents(".modal-content").length&&(n=t.parents(".modal-content"));var a=setTimeout(function(){n.loading(!0,{title:o.loadingTitle})},200);$.ajax({url:o.remote,method:o.method||"GET",data:_.omit(o,["modal","toggle","remote","method","confirm","loadingTitle","success","successTitle","successMessage","error","errorTitle","errorMessage","bs.tooltip","tracking"]),success:function(e){t.trigger("remote.call.success",e)},error:function(e){t.trigger("remote.call.error",e)},complete:function(){clearTimeout(a),n.loading(!1)}})}),$(document).on("remote.call.success","[data-remote]",function(e,t){var o=$(this).data(),n={type:"success",title:o.successTitle,message:t.message||o.successMessage};"object"==typeof t&&"redirect_url"in t?location.href=t.redirect_url:o.success&&("dismiss"==o.success?$.notify(n):(Cookies.set("flash-message",n),"reload"==o.success?location.reload():location.replace(o.success)))}),$(document).on("remote.call.error","[data-remote]",function(e,t){var o=$(this).data();"responseJSON"in t&&(t=t.responseJSON);var n={type:"danger",title:o.errorTitle,message:t.message||o.errorMessage||"Failed loading remote data"};$(this).parents().has(".loading-overlay").loading(!1),$.notify(n)})}),$(function(){$(".navbar:not(.navbar-static)").each(function(){var e=$(this).offset().top,t=$('[data-toggle="navigation-sticky"]');t.length&&(e=t.offset().top+t.outerHeight(),$("body").addClass("nav-fade")),$(window).on("load scroll",function(){$("body").toggleClass("nav-fixed",$(window).scrollTop()>=e)})})}),$(function(){$(document).on("shown.bs.modal",".modal",function(){var e=$(this);e.find("[autofocus]").trigger("focus"),e.find('[data-toggle="tooltip"]').tooltip(),e.find('[data-toggle="popover"]').popover()}),$(document).on("shown.bs.modal",".modal",function(){var e=$(this),t=e.find("#modal-title").text();ga("send","pageview","/modal/"+t),e.on("click",'[data-action="confirm"]',function(){ga("send","event","Modal",t,"Confirm")}),e.on("click",'[data-dismiss="modal"]',function(){ga("send","event","Modal",t,"Cancel")})}),$(document).on("hidden.bs.modal",".modal.rendered",function(){$(this).remove()}),$(document).on("hide.bs.modal",'.modal[data-dismiss="reload"]',function(){location.reload()}),$(document).on("submit",'.modal [data-submit="ajax"]',function(e){var t=$(this);t.parents(".modal-content").loading(!0,{title:t.data("loading-title"),description:t.data("loading-description")})}),$(document).on("form.submit.error",'.modal [data-submit="ajax"]',function(e){$(this).parents(".modal-content").loading(!1)}),$(document).on("form.submit.complete",'.modal [data-submit="ajax"]',function(){"reload"!=$(this).data().success&&$(this).find(".modal-content").loading(!1)}),$(document).on("form.submit.success remote.call.success",'.modal [data-success="dismiss"]',function(){$(this).parents(".modal").modal("hide")}),$(document).on("click","[data-modal]",function(e){e.preventDefault();var o=$(this).data();o.remote?$(this).one("remote.call.success",function(e,t){"remote"==o.modal?($(".modal").modal("hide"),$(t).modal("show")):renderModal(o.modal,$.extend({},o,t))}):renderModal(o.modal,o)}),window.renderModal=function(e,t){var o=templates.render(e+".html",t);$(".modal").modal("hide"),$(o).modal("show"),$(document).trigger("modal.render",{modal:e})}}),$(function(){$(document).on("remote.call.success","[data-cart]",function(e,t){if(e.preventDefault(),t){var o=$('[data-counter="cart_items"]'),n=0===t.cart.cart_items.length;o.text(t.cart.cart_items.length),o.parents(".nav-item").toggleClass("d-none",n),n&&$("#cart-preview-dropdown").collapse("hide");var a=templates.render("cart/_dropdown.html",t);$("#cart-preview-dropdown").html(a),0===$(this).parents(".cart-preview").length&&$("#cart-preview-dropdown").collapse("show"),$(document).trigger("cart.updated",t)}}),$("#cart-preview-dropdown").on("show.bs.collapse",function(){0<$(this).find(".loading").length&&$.ajax({url:"/commerce/ajax/cart/",success:function(e){var t=templates.render("cart/_dropdown.html",e);$("#cart-preview-dropdown").html(t)},error:function(e){$("#cart-preview-dropdown").collapse("hide"),$.notify({type:"danger",title:"Something went wrong",message:"Please try again"})}}),ga("send","pageview","commerce/cart"),$(document).one("click",function(e){0===$(e.target).parents("#cart-preview-dropdown").length&&$("#cart-preview-dropdown").collapse("hide")}),$(".navbar-nav .dropdown").one("show.bs.dropdown",function(){$("#cart-preview-dropdown").collapse("hide")})})}),$(function(){$(document).on("show.bs.tab",'[data-toggle="tab"][href^="#png-"]',function(){var e=$(this).attr("href").replace("#png-",""),t=$("#preview-image").width();t<e&&(e=t),$("#preview-image img").width(e).height(e)}),$(document).on("show.bs.tab",'[data-toggle="tab"][href^="#other"]',function(){var e=$('#other [data-toggle="tab"]');e.find(".active").length||e.first().tab("show")}),$(document).on("click",'[data-action="editor"]',function(){Intercom("trackEvent","icon-opened-in-editor")}),$(document).on("shown.bs.modal","#flag-modal",function(){$('#flag-icon-form [name="url"]').val(window.location.href)}),$(document).on("submit","#flag-icon-form",function(){ga("send","event","Icons","Flag","Icon flagged"),Intercom("trackEvent","icon-reported")}),$(document).on("mouseenter",".formats-help-link",function(){var e=$(this),t=e.siblings(".formats-help-template").html();e.popover({content:t,trigger:"click",html:!0,sanitize:!1})}),$(document).on("click",".formats-help-link",function(e){e.preventDefault()})}),$(function(){var d=function(e,t){var o=t?"check-download":"download",n=["",e.assetType+"s",e.assetId,o,e.assetFormat];!t&&"size"in e&&n.push(e.size);var a=n.join("/");return!t&&"stored_data_id"in e&&(a+="?stored_data_id="+e.stored_data_id),a},c=function(e){var t=templates.render("partials/_pro-counter.html",e);$("#nav-credits-counter").replaceWith(t),$("#nav-credits-counter").tooltip()};$(document).on("download",function(e,t){var o=window.downloadTarget||t.downloadTarget;if(o){var s=$.extend({assetType:"icon",assetId:o.data("asset-id"),assetFormat:Cookies.get("last_download_format")||"png",size:Cookies.get("last_download_size")||256},t);$.ajax({url:d(s,!0),success:function(e){var t=e.is_premium,o={type:"success",title:"Downloading "+(t?"premium":"free")+" "+s.assetType,message:"Please read the license information.",position:"bottom left"};if(t&&"undefined"!=typeof USER&&USER.pro_subscription_usable){var n=-1<e.pro_downloaded_icon_ids_in_period.indexOf(s.assetId),a=$("#nav-credits-counter").data();o.message="The "+s.assetType+" is downloaded under Basic license.",!n&&0<a.credits_count&&(a.credits_count--,o.message+=" You have "+a.credits_count+" credit"+filters.pluralize(a.credits_count)+" left.",c(a))}if("icon"==s.assetType&&(o.tip="Use the <kbd>"+("svg"==s.assetFormat?"S":"P")+"</kbd> key when you hover an icon to download in "+s.assetFormat.toUpperCase()+"."),s.base64){if("svg"==s.assetFormat)$.ajax({url:d(s),dataType:"text",success:function(e){r("data:image/svg+xml;base64,"+Base64.encode(e))}});else{var i=new Image;i.src=d(s),i.onload=function(){var e=document.createElement("canvas");e.width=this.width,e.height=this.height,e.getContext("2d").drawImage(this,0,0),r(e.toDataURL("image/"+s.assetFormat))}}var r=function(e){renderModal("icons/_base64",{format:s.assetFormat.toUpperCase(),datauri:e}),$("body").loading(!1)}}else location.href=d(s),$.notify(o);$(document).trigger("regiser-download",s)},error:function(e){var t="";e.responseJSON&&e.responseJSON.code&&(t=e.responseJSON.code),"no_more_downloads_available"==t?$(document).trigger("pro.upgrade.prompt",e.responseJSON):"download_limit_reached"==t?(renderModal("limiter/_limit-reached",e.responseJSON),ga("send","event","User","Premium download limit","Limit reached")):"registration_required"==t?(renderModal("limiter/_signup-prompt"),ga("send","event","User","Free download limit","Limit reached")):"pro_subscription_required"==t?(renderModal("limiter/_subscription-required"),ga("send","event","User","Pro subscription required",s.assetFormat)):$.notify({type:"danger",title:"Something went wrong",message:"Please try again or reload the page."})}})}}),$(document).on("regiser-download",function(e,t){"assetFormat"in t&&Cookies.set("last_download_format",t.assetFormat),"size"in t&&Cookies.set("last_download_size",t.size),ga("send","event",filters.title(t.assetType),"Download",t.assetFormat.toLowerCase()),Intercom("trackEvent","icon-download")}),$(document).on("click","#download-zip-modal [data-params]",function(){var e=$(this).data("params").split("|"),t={assetType:e[0],assetFormat:e[1]};"None"!==e[2]&&(t.size=e[2]),$(document).trigger("regiser-download",t);var o={type:"success",title:"Downloading icons",message:"Please read the license information.",position:"bottom left"};if("undefined"!=typeof USER&&USER.pro_subscription_usable&&0<e[3]){var n=$("#nav-credits-counter").data();0<n.credits_count&&(n.credits_count=n.credits_count-e[3],o.message+=" You have "+n.credits_count+" credit"+filters.pluralize(n.credits_count)+" left.",c(n))}$("#download-zip-modal").modal("hide"),$.notify(o)}),$(document).on("click",'[data-action="download"]',function(e){e.preventDefault();var t=$(this),o=t.data();o.downloadTarget=t,$(document).trigger("download",o)}),$(document).on("keydown",null,"d",function(){$(document).trigger("download")}),$(document).on("keydown",null,"s",function(){$(document).trigger("download",{assetFormat:"svg"})}),$(document).on("keydown",null,"p",function(){$(document).trigger("download",{assetFormat:"png"})}),$(document).on("mouseenter",".icon-preview, #icon-details-preview",function(){window.downloadTarget=$(this)}).on("mouseleave",".icon-preview, #icon-details-preview",function(){window.downloadTarget=null}),$(document).on("download",function(){var e=window.downloadTarget;e&&e.is(".icon-preview")&&(e.addClass("highlight"),setTimeout(function(){e.removeClass("highlight")},500))})}),$(function(){$("#prepayment-form").on("change",'[name="predefined"]',function(){var e=$(this),t=e.val(),o=e.parents("form"),n=$("#custom-amount");""===t?n.collapse("show"):n.collapse("hide"),o.removeClass("was-validated"),o.find('input[name="amount"]').val(t)}),$("#prepayment-form").on("submit",function(){var e=$(this),t=e.find('[name="amount"]'),o=parseFloat(t.val()).toFixed(2),n=100*o;e.find('[name="amount_cents"]').val(n),ga("send","event","Commerce","Make prepayment","Amount",o)})}),$(function(){$(document).on("mouseenter","[data-profile]",function(){var t=$(this),e=t.data("profile");if(!($(window).width()<600)){var o=setTimeout(function(){$.get("/profiles/ajax/"+e+"/summary",function(e){t.popover({trigger:"manual",html:!0,sanitize:!1,content:$(e)[0].innerHTML,template:'<div class="popover popover-profile" style="width: 100%;"><div class="arrow"></div><div class="popover-body p-0"></div></div>'}).popover("show"),$(".popover-profile").on("mouseenter",function(){$(this).addClass("focus")}),$(".popover-profile").on("mouseleave",function(){t.popover("dispose")}),$(document).on("modal.render",function(){t.popover("dispose")}),t.on("mouseleave",function(){setTimeout(function(){$(".popover-profile").hasClass("focus")||t.popover("dispose")},200)})})},500);t.on("mouseleave",function(){clearTimeout(o)})}}),$(document).on("show.bs.popover",function(){$(".popover-profile [autofocus]").focus()})}),$(function(){$.fn.countdown=function(){var n=this,a=n.data("countdown");a&&(a=a.split("+")[0],a=dayjs.utc(a),setInterval(function(){var e=dayjs.utc(),t=dayjs.utc(a.diff(e)),o={day:a.diff(e,"day"),hour:t.format("HH"),minute:t.format("mm"),second:t.format("ss"),total:a.diff(e,"hour")+t.format(":mm:ss")};$.each(o,function(e,t){n.find("."+e).text(t)})},1e3))},$("[data-countdown]").countdown()}),$(function(){$.ajax({url:"/marketing/banner",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},success:function(e){$("body").append(e),$(".in-app-banner").trigger("banner.shown")}}),$(document).on("click",'.in-app-banner [data-dismiss="banner"]',function(){var e=$(this).parents(".in-app-banner"),t="dismissed_"+e.attr("id"),o=e.data("expires")?new Date(e.data("expires")):.25;Cookies.set(t,"true",{expires:o}),e.fadeOut(function(){$(this).remove()})}),$(document).on("banner.shown",".in-app-banner",function(){$(this).find("[data-countdown]").countdown()})});var editor={init:function(){this.modal=$("#editor-modal"),this.image=$("#editor-modal #svg-data"),this.icon_id=this.image.data("id"),this.has_edits=!1,this.original_preview=$("#preview-image img").attr("src"),this.original_svg=$("#editor-modal #svg-data").html(),this.original_colors=$("#editor-modal .colors-list .color-group").map(function(e,t){return $(t).data("originalColor")}),this.current_version_id="original",this.colorpicker(),this.versions.list(),this.palettes.render(),this.downloadPopover()},validate_color:function(e){return/^#[0-9A-F]{6}$/i.test(e)},mapOriginalColors:function(){$.each(["fill","stroke","stop-color"],function(e,o){editor.image.find("svg ["+o+"]").each(function(){var e=$(this),t=e.attr(o).toLowerCase().replace("#","-");"none"!=t&&e.addClass(o+t)})})},updateColors:function(e){var t=templates.render("recolor/_colors.html",{colors:e});editor.modal.find(".colors-list").html(t),editor.colorpicker()},colorpicker:function(){editor.mapOriginalColors(),editor.modal.find(".minicolors-input-picker").each(function(){var e=$(this),a=e.data("originalColor"),t=e.parents(".tab-pane").find(".minicolors-input-field");e.minicolors({theme:"bootstrap",inline:!0,change:function(n){editor.has_edits=!0,$.each(["fill","stroke","stop-color"],function(e,t){var o="svg ."+t+a.toLowerCase().replace("#","-");editor.image.find(o).attr(t,n)}),editor.modal.find(".color-group.active").css("background-color",n),t.val(n),editor.modal.find(".tab-pane.active .reset-color").toggleClass("d-none",a==n)}})})},versions:{list:function(){$.get("/stored_data/list/icon-"+editor.icon_id,function(e){var t=[{id:"original",preview_url:editor.original_preview,timepassed:"Original"}];"stored_data_objects"in e&&0<e.stored_data_objects.length&&$.merge(t,e.stored_data_objects.slice(0,5));var o=templates.render("recolor/_versions.html",{versions:t});editor.modal.find(".versions-placeholder").html(o)})},load:function(e){editor.current_version_id=e,editor.has_edits=!1,"original"==e?(editor.image.find("svg").replaceWith(editor.original_svg),editor.updateColors(editor.original_colors)):(editor.modal.loading(!0),$.ajax({url:"/stored_data/get/"+e,success:function(e){editor.image.find("svg").replaceWith(e.data),editor.updateColors(e.colors),editor.modal.loading(!1)},error:function(){$.notify({type:"error",title:"Something went wrong",message:"Could not load saved version"})}}))},save:function(){if(editor.has_edits){var e=editor.image.find("svg").prop("outerHTML");$.ajax({url:"/stored_data/save/icon-"+editor.icon_id,method:"POST",data:{svg_data:e},success:function(e){editor.has_edits=!1,editor.current_version_id=e.stored_data_object.id,editor.updateDownloadButtons(),editor.versions.list()},error:function(e){$.notify({type:"error",title:"Something went wrong",message:"Could not save version"})}})}}},palettes:{key:"saved-colors",list:function(){var e=localStorage.getItem(editor.palettes.key);return e?JSON.parse(e):[]},render:function(){var e=templates.render("recolor/_palettes.html",{colors:editor.palettes.list()});editor.modal.find(".palettes-list").html(e),editor.modal.find('.palettes-list [data-toggle="tooltip"]').tooltip()},load:function(e){editor.validate_color(e)&&editor.modal.find(".tab-pane.active .minicolors-input-field").val(e).trigger("change")},save:function(e){if(editor.validate_color(e)){var t=editor.palettes.list();t.unshift(e);var o=t.filter(function(e,t,o){return t===o.indexOf(e)}).slice(0,10);localStorage.setItem(editor.palettes.key,JSON.stringify(o)),editor.palettes.render()}}},updateDownloadButtons:function(){"original"!=editor.current_version_id&&$('.popover .icon-download [data-action="download"]').data("stored_data_id",editor.current_version_id)},downloadPopover:function(){var e=$("#editor-download").html(),t=editor.modal.find(".download-button");t.popover({html:!0,sanitize:!1,content:e,placement:"top"}),t.on("shown.bs.popover",function(){editor.updateDownloadButtons(),$(document).on("click.download-popover",function(e){$(e.target).parents(".popover").length||(t.popover("hide"),$(document).off("click.download-popover"))}),$('.popover .icon-download [data-toggle="tab"]').on("show.bs.tab",function(){t.popover("update")})})}};$(function(){$(document).on("shown.bs.modal","#editor-modal",function(){editor.init()}),$(document).on("hide.bs.modal","#editor-modal",function(){if(editor.has_edits)return confirm("Are you sure you want to close without saving your changes?")}),$(document).on("click",'#editor-modal [data-action="save"]',editor.versions.save),$(document).on("click","#editor-modal [data-version_id]",function(){if(confirm("Are you sure you want to load this version? Any current changes will be lost.")){var e=$(this).data("version_id");editor.versions.load(e)}}),$(document).on("change","#editor-modal .minicolors-input-field",function(){var e=$(this),t=e.val();e.parents(".tab-pane").find(".minicolors-input-picker").minicolors("value",{color:t})}),$(document).on("show.bs.tab",'[data-toggle="tab"][href^="#other-modal"]',function(){var e=$('#other-modal [data-toggle="tab"]');e.find(".active").length||e.first().tab("show")}),$(document).on("click",'[data-action="save-color"]',function(){var e=$(".tab-pane.active .minicolors-input-field").val();editor.palettes.save(e)}),$(document).on("click",'[data-action="load-color"]',function(e){e.preventDefault();var t=$(this).data("color");editor.palettes.load(t)})});
//# sourceMappingURL=https://www.iconfinder.com/static/js/iconfinder.js.map
