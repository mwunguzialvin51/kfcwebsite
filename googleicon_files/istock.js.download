$(function(){var i={init:function(){this.placeholder(),this.attach()},placeholder:function(){if(!(0<$("#istockphoto-placeholder").length)&&0!==$(".icon-grid").length){var e=$(".icon-grid .icon-preview"),t=Math.round($(".icon-grid").width()/$(".icon-preview").width()),o=$(window).height()-$(".icon-grid").offset().top,r=Math.floor(o/$(".icon-preview").height()),i=Math.floor(e.length/t);r<4&&(r=4),i<r?r=i:r--;var a=t*r,n=$("<div />",{id:"istockphoto-placeholder","data-phrase":$(".suggestions .new_query strong").text()||$("[data-phrase]").data("phrase")||$.url().param("q")||""});a>e.length&&(a=e.length),e.eq(a-1).after(n)}},in_view:function(){if(0===$("#istockphoto-placeholder").length)return!1;var e=$(window).scrollTop(),t=$(window).height(),o=$("#istockphoto-placeholder").offset().top;return o<=t+e},attach:function(){0!==$("#istockphoto-placeholder").length&&(i.in_view()?i.fetch():this.defer())},defer:function(){0!==$("#istockphoto-placeholder").length&&$(window).on("scroll.istock",function(){i.in_view()&&(i.fetch(),$(window).off("scroll.istock"))})},search_data:function(e){var t=$("#istockphoto-placeholder").data(),o={sort_order:t.sort_order||"best_match",phrase:t.phrase,graphical_styles:"illustration,vector",exclude_nudity:"true",orientations:"square",page_size:24,fields:"summary_set,referral_destinations",include_related_searches:!0};return e&&(o.phrase=i.search_history()),o},search_history:function(){var e=localStorage.getItem("search_history");if(e){var t=JSON.parse(e);if(0<t.length&&"value"in t[0])return t[0].value}return!1},fetch:function(o){var r=i.search_data(o);$.ajax({url:"https://api.gettyimages.com/v3/search/images/creative",data:r,headers:{"Api-Key":"mumzxpc2xmrksfyv7fj9d2uz"},success:function(e){var t={phrase:r.phrase,sharedid:r.sharedid||"SRP"};t.images=$.map(e.images,function(e){return{thumbnail:_.findWhere(e.display_sizes,{name:"thumb"}),link:_.findWhere(e.referral_destinations,{site_name:"istockphoto"})}}),"related_searches"in e&&0<e.related_searches.length&&(t.related_searches=e.related_searches.slice(0,6)),t.images.length<3&&!o&&i.search_history()?i.fetch(!0):i.render(t)}})},render:function(e){var t="ads/_istock.html";e.images.length<3&&(t="ads/_istock_generic.html",ga("send","event","iStock","Show Banner","Fallback"));var o=templates.render(t,e);$("#istockphoto-placeholder").html(o),$('#istockphoto-banner [data-toggle="tooltip"]').tooltip()}};i.init(),$(document).on("search.results",function(){i.init()}),$(document).on("click",'[data-trigger="istock-popup"]',function(){var e=$.map({width:600,height:400,left:100,top:100,menubar:"no",toolbar:"no",location:"no",status:"no"},function(e,t){return t+"="+e}).join(",");window.open("/marketing/istock-code","Discount code",e)})});
//# sourceMappingURL=https://www.iconfinder.com/static/js/istock.js.map
